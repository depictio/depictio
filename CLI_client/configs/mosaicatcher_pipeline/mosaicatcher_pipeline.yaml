depictio_version: "0.1.0"
workflows:
  - engine: "snakemake"
    name: "mosaicatcher-pipeline"
    description: "Strand-Seq SV calling framework"
    repository: "https://github.com/friendsofstrandseq/mosaicatcher-pipeline"
    config:
      parent_runs_location:
        - "/Users/tweber/Data/mosaicatcher-pipeline"
      runs_regex: ".*"
    data_collections:
      - data_collection_tag: "mosaicatcher_stats"
        description: "Statistics file generated by MosaiCatcher"
        config:
          type: "Table"
          files_regex: ".*.info_raw"
          format: "TSV"
          polars_kwargs:
            skip_rows: 13
            separator: "\t"
          keep_columns:
            - "sample"
            - "cell"
            - "mapped"
            - "dupl"
            - "pass1"
            - "good"

          # TODO: FIX BUG ABOUT OBJECTID
          table_join:
            on_columns:
              - "sample"
              - "cell"
            how: "inner"
            with_dc:
              - "ashleys_labels"

      - data_collection_tag: "ashleys_labels"
        description: "Probabilities generated by ashleys-qc model"
        config:
          type: "Table"
          files_regex: "labels.tsv"
          format: "TSV"
          polars_kwargs:
            separator: "\t"

      - data_collection_tag: "SV_calls"
        description: "BED files containing SV calls generated by MosaiCatcher"
        config:
          type: "Genome Browser"

          files_regex: "{cell}-SV.bed.gz"
          regex_wildcards:
            - name: "cell"
              regex: ".*"
              join_data_collection: "mosaicatcher_stats"

          format: "BED"
          index_extension: "tbi"
          jbrowse_template_location: "/Users/tweber/Gits/depictio/CLI_client/configs/mosaicatcher_pipeline/jbrowse2_templates/SV_calls.json"
